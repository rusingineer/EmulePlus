head	1.3;
access;
symbols
	PublicRelease_1_2e:1.3
	Interim_Release_1-2e_RC1:1.3
	PublicRelease_1_2d:1.3
	Interim_Release_1-2d_RC1:1.3
	Interim_Release_1-2d_beta1:1.3
	PublicRelease_1_2c:1.3
	Interim_Release_1-2c_RC1:1.3
	Interim_Release_1-2c_beta1:1.3
	PublicRelease_1_2b:1.3
	Interim_Release_1-2b_RC1:1.3
	PublicRelease_1_2a:1.3
	Interim_Release_1-2a_RC1:1.3
	Interim_Release_1-2a_beta2:1.3
	Interim_Release_1-2a_beta1:1.3
	PublicRelease_1_2:1.3
	Interim_Release_1-2_RC1:1.3
	Interim_Release_1-2_beta1:1.3
	PublicRelease_1_1g:1.3
	Interim_Release_1-1g_RC3:1.3
	Interim_Release_1-1g_RC2:1.3
	Interim_Release_1-1g_RC1:1.3
	Interim_Release_1-1g_beta2:1.3
	Interim_Release_1-1g_beta1:1.3
	PublicRelease_1_1f:1.3
	Interim_Release_1-1f_RC1:1.3
	PublicRelease_1_1e:1.3
	Interim_Release_1-1e_RC2:1.3
	Interim_Release_1-1e_RC1:1.3
	Interim_Release_1-1e_beta1:1.3
	PublicRelease_1_1d:1.3
	Interim_Release_1-1d_RC1:1.3
	PublicRelease_1_1c:1.3
	Interim_Release_1-1c_RC1:1.3
	Interim_Release_1-1c_beta2:1.3
	Interim_Release_1-1c_beta1:1.3
	PublicRelease_1_1b:1.2;
locks; strict;
comment	@ * @;


1.3
date	2005.01.23.07.36.38;	author kuchin;	state Exp;
branches;
next	1.2;

1.2
date	2004.12.26.15.45.32;	author kuchin;	state Exp;
branches;
next	1.1;

1.1
date	2004.12.26.10.37.13;	author kuchin;	state Exp;
branches;
next	;


desc
@@


1.3
log
@More v2 Xml WebInterface
@
text
@#pragma once

#import "msxml.dll"

#define XmlDoc		MSXML::IXMLDOMDocumentPtr 
#define XmlNodes	MSXML::IXMLDOMNodeListPtr
#define XmlNode		MSXML::IXMLDOMNodePtr
#define XmlElement	MSXML::IXMLDOMElementPtr
#define XmlNodeMap	MSXML::IXMLDOMNamedNodeMapPtr

XmlDoc	XmlLoadDocumentFromFile(CString szFile);
XmlDoc	XmlLoadDocumentFromStr(CString sXml);
XmlDoc	XmlCreateDocument();
bool	XmlInsertProcessingInstruction(XmlDoc spDoc, CString sInstruction, CString sData);
XmlNode	XmlCreateElement(XmlDoc spDoc, XmlNode spParent, CString sElementName);
bool	XmlSetAttribute(XmlElement spElem, CString sAttribName, variant_t vtValue);
CString	XmlGetAttributeStr(XmlElement spElem, CString sAttribute);
long	XmlGetAttributeLong(XmlElement spElem, CString sAttribute, long lDefault = -1);
@


1.2
log
@Rearrangements
@
text
@d11 8
a18 7
XmlDoc XmlLoadDocumentFromFile(CString szFile);
XmlDoc XmlLoadDocumentFromStr(CString sXml);
XmlDoc XmlCreateDocument();
XmlNode XmlCreateElement(XmlDoc spDoc, CString sElementName);
bool XmlSetAttribute(XmlElement spElem, CString sAttribName, variant_t vtValue);
CString XmlGetAttributeStr(XmlElement spElem, CString sAttribute);
long XmlGetAttributeLong(XmlElement spElem, CString sAttribute, long lDefault = -1);
@


1.1
log
@Forgotten file
@
text
@d11 7
a17 23
inline MSXML::IXMLDOMDocumentPtr XmlLoadDocumentFromFile(CString szFile)
{
	XmlDoc spDoc;
	spDoc.CreateInstance(__uuidof(DOMDocument));
	if(spDoc->load(variant_t(szFile)) == VARIANT_TRUE)
		return spDoc;
	else
		return NULL;
}

inline CString XmlGetAttributeStr(XmlElement spElem, CString sAttribute)
{
	EMULE_TRY
	XmlNodeMap spAttrMap = spElem->attributes;
	if(spAttrMap != NULL)
	{
		XmlNode spNode = spAttrMap->getNamedItem(bstr_t(sAttribute));
		if(spNode)
			return (LPCTSTR)spNode->text;
	}
	EMULE_CATCH
	return _T("");
}@

