head	1.4;
access;
symbols
	PublicRelease_1_2e:1.4
	Interim_Release_1-2e_RC1:1.4
	PublicRelease_1_2d:1.4
	Interim_Release_1-2d_RC1:1.4
	Interim_Release_1-2d_beta1:1.4
	PublicRelease_1_2c:1.4
	Interim_Release_1-2c_RC1:1.4
	Interim_Release_1-2c_beta1:1.4
	PublicRelease_1_2b:1.4
	Interim_Release_1-2b_RC1:1.4
	PublicRelease_1_2a:1.4
	Interim_Release_1-2a_RC1:1.4
	Interim_Release_1-2a_beta2:1.4
	Interim_Release_1-2a_beta1:1.4
	PublicRelease_1_2:1.4
	Interim_Release_1-2_RC1:1.4
	Interim_Release_1-2_beta1:1.4
	PublicRelease_1_1g:1.4
	Interim_Release_1-1g_RC3:1.4
	Interim_Release_1-1g_RC2:1.4
	Interim_Release_1-1g_RC1:1.4
	Interim_Release_1-1g_beta2:1.4
	Interim_Release_1-1g_beta1:1.4
	PublicRelease_1_1f:1.4
	Interim_Release_1-1f_RC1:1.4
	PublicRelease_1_1e:1.4
	Interim_Release_1-1e_RC2:1.4
	Interim_Release_1-1e_RC1:1.4
	Interim_Release_1-1e_beta1:1.4;
locks; strict;
comment	@// @;


1.4
date	2005.04.11.16.32.21;	author kuchin;	state Exp;
branches;
next	1.3;

1.3
date	2005.04.08.11.09.34;	author kuchin;	state Exp;
branches;
next	1.2;

1.2
date	2005.03.27.05.01.50;	author kuchin;	state Exp;
branches;
next	1.1;

1.1
date	2005.03.22.22.02.09;	author kuchin;	state Exp;
branches;
next	;


desc
@@


1.4
log
@v2 - logging subsystem
@
text
@// Server.cpp: implementation of the server classes
//
//////////////////////////////////////////////////////////////////////

#include "stdafx.h"
#include "Loggable2.h"
#ifdef SUPPORT_CLIENT_PEER
	#include "../Database/TaskProcessorDB.h"
#endif //SUPPORT_CLIENT_PEER


void CLoggable2::AddLog(EnumLogType eType, LPCTSTR szLine, ...)
{
	va_list argptr;
	va_start(argptr, szLine);
	if(szLine)
	{
		// Make string
		CString sBuffer;
		sBuffer.FormatV(szLine, argptr);

		CPreciseTime tmNow = CPreciseTime::GetCurrentTime();

		// Output
		if(eType >= LOG_ERROR)
			TRACE(_T("***** "));
		TRACE(CString(tmNow.FullTime) + _T("  ") + sBuffer + _T("\n"));

		if(eType >= LOG_ERROR && g_stEngine.AlertOnErrors())
			ASSERT(FALSE);

#ifdef SUPPORT_CLIENT_PEER
		CTask_AddToLog *pTask = new CTask_AddToLog(eType, tmNow, sBuffer);
		g_stEngine.DB.Push(pTask);
#endif //SUPPORT_CLIENT_PEER
	}
	va_end(argptr);
}
@


1.3
log
@v2 - increased level of abstraction + minor improvements
@
text
@d7 4
d31 5
@


1.2
log
@v2 - minor improvements
@
text
@d25 1
a25 1
		if(eType >= LOG_ERROR)
@


1.1
log
@v2 - enhancing logging subsystem
@
text
@d22 1
a22 1
			TRACE(_T("!!! "));
@

